using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Invulnerability : MonoBehaviour
{
    public PlayerMovement pmInfo;
    public Renderer playerRenderer;
    public Renderer armaRenderer;
    public float invulnerableLength = 1f;
    float invulnerableCounter;

    public float flashLength = 0.1f;
    float flashCounter;

    private void Update()
    {
        if(invulnerableCounter > 0)
        {
            invulnerableCounter -= Time.deltaTime;

            flashCounter -= Time.deltaTime;
            if(flashCounter <= 0)
            {
                playerRenderer.enabled = !playerRenderer.enabled;
                armaRenderer.enabled = !armaRenderer.enabled;
                flashCounter = flashLength;
            }

            if (invulnerableCounter <= 0)
            {
                playerRenderer.enabled = true;
                armaRenderer.enabled = true;
            }
        }
    }

    void OnTriggerEnter(Collider collision)
    {
        if(collision.gameObject.layer == 10 && invulnerableCounter <= 0 && !pmInfo.playerIsDead)
        {
            pmInfo.playerHealth--;
            pmInfo.animator.SetTrigger("GetDamaged");
            invulnerableCounter = invulnerableLength;
            playerRenderer.enabled = false;
            armaRenderer.enabled = false;
            flashCounter = flashLength;
        }
    }
}
